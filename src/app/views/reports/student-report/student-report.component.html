<div class="testName">Test Name: <strong>{{fetchedWholeAssignmentResult?.testName}}</strong> </div>
<div class="card-stats-container">
  <div class="card-stats">
    <div class="card-stats-body">
      <div class="card-title card-bg-pink">
        <div class="card-icon">
          <span><i class="fas fa-question"></i></span>
        </div>
        Questions Statistics
      </div>
      <div class="card-body">
        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.totalQuestions}} </span><br>
            <span><i class="fas fa-align-justify"  style="color: blue;margin-right: 5px;" ></i>Total Questions</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.attempted}} </span><br>
            <span><i class="fas fa-pen" style="color: #9e9e9e;margin-right: 5px;" ></i>Attempted Questions</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.skipped}} </span><br>
            <span><i class="fas fa-forward"  style="color: orangered;margin-right: 5px;" ></i>Skipped Questions</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.correct}} </span><br>
            <span><i class="fas fa-check-circle" style="color: green;margin-right: 5px;"></i> Correct Questions</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.incorrect}} </span><br>
            <span><i class="fas fa-times-circle" style="color: red;margin-right: 5px;"></i>Incorrect Questions</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card-stats">
    <div class="card-stats-body">
      <div class="card-title card-bg-blue">
        <div class="card-icon">
          <span><i class="fas fa-poll"></i></span>
        </div>
        Marks Statistics
      </div>
      <div class="card-body">
        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.totalMarks}} </span><br>
            <span><i class="fas fa-align-justify"  style="color: blue;margin-right: 5px;" ></i>Total Marks</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.marksReceived}} </span><br>
            <span><i class="fas fa-poll" style="color: #9e9e9e;margin-right: 5px;" ></i>Marks Recieved</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.skippedMarks}} </span><br>
            <span><i class="fas fa-forward"  style="color: orangered;margin-right: 5px;" ></i>Skipped Marks</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.positiveMarks}} </span><br>
            <span><i class="fas fa-plus-circle" style="color: green;margin-right: 5px;"></i>Positive Marks</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.negativeMarks}} </span><br>
            <span><i class="fas fa-minus-circle" style="color: red;margin-right: 5px;"></i>Negative Marks</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card-stats">
    <div class="card-stats-body">
      <div class="card-title card-bg-orange">
        <div class="card-icon">
          <span><i class="far fa-clock"></i></span>
        </div>
        Time Statistics
      </div>
      <div class="card-body">
        <div class="stats">
          <div class="card-subtitle">
            <span> {{(metrics?.totalTimeInSec / 60)  | number  }} min</span><br>
            <span><i class="fas fa-hourglass-half"  style="color: blue;margin-right: 5px;" ></i>Total Time</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.correctTimeInSec  / 60 | number}} min</span><br>
            <span><i class="fas fa-hourglass-start" style="color: green;margin-right: 5px;" ></i>Correct Time</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.incorrectTimeInSec  / 60 | number}} min</span><br>
            <span><i class="fas fa-hourglass-end"  style="color: red;margin-right: 5px;" ></i>Incorrect Time</span>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<div style="margin: 0px 20px">
  <mat-button-toggle-group #filterToggle="matButtonToggleGroup"
  (change)="showFilteredData($event.value)"  [value]="currentSelection"
                           aria-label="Change Filter">
    <mat-button-toggle  *ngFor="let filterItem of filterList" [value]="filterItem" > {{ filterItem }} </mat-button-toggle>
  </mat-button-toggle-group>
</div>


<div *ngIf="currentSelection != 'Solution'" class="student-report-list-grid">
  <div class="mat-elevation-z8">
    <div class="loading-container" *ngIf="isLoading">
      <mat-spinner *ngIf="isLoading"></mat-spinner>
    </div>
    <div class="mat-elevation-z8">
      <div>
        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          matSortActive="name"
          matSortDisableClear
        >
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
            <td mat-cell *matCellDef="let row">{{ row.name }}</td>
          </ng-container>

          <ng-container matColumnDef="questions">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Questions</th>
            <td mat-cell *matCellDef="let row">{{ row.questions }}</td>
          </ng-container>

          <ng-container matColumnDef="timeTaken">
            <th mat-header-cell *matHeaderCellDef>Time Taken (in sec)</th>
            <td mat-cell *matCellDef="let row">
              {{ row.timeTaken }}
            </td>
          </ng-container>

          <ng-container matColumnDef="attempt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Attempt</th>
            <td mat-cell *matCellDef="let row">{{ row.attempt }}</td>
          </ng-container>

          <ng-container matColumnDef="incorrect">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Incorrect</th>
            <td mat-cell *matCellDef="let row">{{ row.incorrect }}</td>
          </ng-container>
          <ng-container matColumnDef="skipped">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Skipped</th>
            <td mat-cell *matCellDef="let row">{{ row.skipped }}</td>
          </ng-container>

          <ng-container matColumnDef="score">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Score</th>
            <td mat-cell *matCellDef="let row">{{ row.score }}</td>
          </ng-container>
          <ng-container matColumnDef="correct">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Correct</th>
            <td mat-cell *matCellDef="let row">{{ row.correct }}</td>
          </ng-container>

          <ng-container matColumnDef="accuracy">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Accuracy %
            </th>
            <td mat-cell *matCellDef="let row">{{ row.accuracy }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </div>

    </div>
  </div>
</div>

<div  *ngIf="currentSelection == 'Solution'"  class="student-report-list-grid">
  <mat-tab-group [color]="'primary'" [backgroundColor]="'primary'">
    <mat-tab *ngFor="let section of fetchedWholeAssignmentResult.sections" [label]="section.sectionName">
      <div *ngFor="let answer of section.answers; let i = index;" style="margin-bottom: 20px;">
        <div style="display: flex; margin-bottom: 10px;">
          <div class="numberCircle">{{i + 1}}</div>
          <div class="questionName" [innerHtml]="transform(answer.name)"></div>
        </div>

        <div style="margin-left: 30px;">
            <div class="option"[ngClass]="{'correct': answer.correctOptions?.includes(option.key),
             'selected' : answer.selectedOptions?.includes(option.key),  'wrong' : !answer.correctOptions?.includes(option.key) }"
            *ngFor="let option of answer.inputOptions" >
              <div class="markcontainer">
                <i *ngIf="answer.answerStatus == 'CORRECT' && answer.correctOptions.includes(option.key)"  style="color: green" class="fas fa-check-circle"></i>
                <i *ngIf="answer.answerStatus == 'INCORRECT' && answer.selectedOptions.includes(option.key) " style="color: red"  class="fas fa-times-circle"></i>
              </div>
              <div [innerHtml]="transform(option.value)"></div>
            </div>
        </div>

        <div *ngIf="answer.type == 'TITA'" style="margin-left: 30px;">
            <div class="option correct">
              <div [innerHtml]="transform(answer.correctAnswerText)"></div>
            </div>
            <div class="option" [ngClass]="{'correct': answer.answerStatus  == 'CORRECT' ,  'wrong' : answer.answerStatus  == 'INCORRECT' }">
              <div [innerHtml]="transform(answer.answerText)"></div>
            </div>
        </div>
      </div>

    </mat-tab>

  </mat-tab-group>
</div>

