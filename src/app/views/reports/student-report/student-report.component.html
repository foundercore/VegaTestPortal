<div class="testName">Test Name: <strong>{{fetchedWholeAssignmentResult?.testName}}</strong> </div>
<div class="card-stats-container">
  <div class="card-stats">
    <div class="card-stats-body">
      <div class="card-title card-bg-pink">
        <div class="card-icon">
          <span><i class="fas fa-question"></i></span>
        </div>
        Questions Statistics
      </div>
      <div class="card-body">
        <div class="sub-stats">
          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.totalQuestions}} </span><br>
              <span><i class="fas fa-align-justify icon-space primary" ></i>Total Questions</span>
            </div>
          </div>

          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.attempted}} </span><br>
              <span><i class="fas fa-pen icon-space info" ></i>Attempted Questions</span>
            </div>
          </div>
        </div>

        <div class="sub-stats">
          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.skipped}} </span><br>
              <span><i class="fas fa-forward icon-space warning" ></i>Skipped Questions</span>
            </div>
          </div>

          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.correct}} </span><br>
              <span><i class="fas fa-check-circle success icon-space"></i> Correct Questions</span>
            </div>
          </div>

          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.incorrect}} </span><br>
              <span><i class="fas fa-times-circle icon-space failure" ></i>Incorrect Questions</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card-stats">
    <div class="card-stats-body">
      <div class="card-title card-bg-blue">
        <div class="card-icon">
          <span><i class="fas fa-poll"></i></span>
        </div>
        Marks Statistics
      </div>
      <div class="card-body">
        <div class="sub-stats">
          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.totalMarks}} </span><br>
              <span><i class="fas fa-align-justify icon-space primary" ></i>Total Marks</span>
            </div>
          </div>

          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.marksReceived}} </span><br>
              <span><i class="fas fa-poll  icon-space info" ></i>Marks Recieved</span>
            </div>
          </div>
        </div>

        <div class="sub-stats">
          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.skippedMarks}} </span><br>
              <span><i class="fas fa-forward icon-space warning"  ></i>Skipped Marks</span>
            </div>
          </div>

          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.positiveMarks}} </span><br>
              <span><i class="fas fa-plus-circle success icon-space"></i>Positive Marks</span>
            </div>
          </div>

          <div class="stats">
            <div class="card-subtitle">
              <span> {{metrics?.negativeMarks}} </span><br>
              <span><i class="fas fa-minus-circle icon-space failure"  ></i>Negative Marks</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card-stats">
    <div class="card-stats-body">
      <div class="card-title card-bg-orange">
        <div class="card-icon">
          <span><i class="far fa-clock"></i></span>
        </div>
        Time Statistics
      </div>
      <div class="card-body">
        <div class="stats">
          <div class="card-subtitle">
            <span> {{(metrics?.totalTimeInSec)  | minuteSeconds }} min</span><br>
            <span><i class="fas fa-hourglass-half icon-space primary"></i>Total Time</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.correctTimeInSec | minuteSeconds}} min</span><br>
            <span><i class="fas fa-hourglass-start  success icon-space"></i>Correct Time</span>
          </div>
        </div>

        <div class="stats">
          <div class="card-subtitle">
            <span> {{metrics?.incorrectTimeInSec  | minuteSeconds}} min</span><br>
            <span><i class="fas fa-hourglass-end icon-space failure"></i>Incorrect Time</span>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<div style="margin: 0px 20px">
  <mat-button-toggle-group #filterToggle="matButtonToggleGroup"
  (change)="showFilteredData($event.value)"  [value]="currentSelection"
                           aria-label="Change Filter">
    <mat-button-toggle  *ngFor="let filterItem of filterList" [value]="filterItem" > {{ filterItem }} </mat-button-toggle>
  </mat-button-toggle-group>
</div>


<container-element [ngSwitch]="currentSelection">


<div *ngSwitchDefault   class="student-report-list-grid">
  <div class="mat-elevation-z8">
    <div class="loading-container" *ngIf="isLoading">
      <mat-spinner *ngIf="isLoading"></mat-spinner>
    </div>
    <div class="mat-elevation-z8">
      <div>
        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          matSortActive="name"
          matSortDisableClear
        >


          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <div>Name</div>
            </th>
            <td mat-cell *matCellDef="let row">{{ row.name }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> Total </td>
          </ng-container>

          <ng-container matColumnDef="questions">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Questions</th>
            <td mat-cell *matCellDef="let row">{{ row.questions }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> {{ getTotal('questions') }} </td>

          </ng-container>

          <ng-container matColumnDef="timeTaken">
            <th mat-header-cell *matHeaderCellDef>Time Taken (in min)</th>
            <td mat-cell *matCellDef="let row">
              {{ row.timeTaken | minuteSeconds }}
            </td>
            <td mat-footer-cell *matFooterCellDef class="footer-stye"> {{ getTotal('timeTaken') | minuteSeconds}} </td>
          </ng-container>

          <ng-container matColumnDef="attempt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Attempt</th>
            <td mat-cell *matCellDef="let row">{{ row.attempt }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> {{ getTotal('attempt') }} </td>
          </ng-container>

          <ng-container matColumnDef="incorrect">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Incorrect</th>
            <td mat-cell *matCellDef="let row">{{ row.incorrect }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> {{ getTotal('incorrect') }} </td>
          </ng-container>

          <ng-container matColumnDef="skipped">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Skipped</th>
            <td mat-cell *matCellDef="let row">{{ row.skipped }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> {{ getTotal('skipped') }} </td>
          </ng-container>

          <ng-container matColumnDef="score">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Score</th>
            <td mat-cell *matCellDef="let row">{{ row.score }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye">{{ getTotal('score')}} </td>
          </ng-container>

          <ng-container matColumnDef="correct">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Correct</th>
            <td mat-cell *matCellDef="let row">{{ row.correct }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> {{ getTotal('correct') }}  </td>
          </ng-container>

          <ng-container matColumnDef="accuracy">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Accuracy %
            </th>
            <td mat-cell *matCellDef="let row">{{ row.accuracy }}</td>
            <td mat-footer-cell *matFooterCellDef  class="footer-stye"> {{ getTotal('accuracy') }} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>

        </table>
      </div>

    </div>
  </div>
</div>

<div  *ngSwitchCase="'Solution'"  class="student-report-list-grid">
  <mat-tab-group >
    <mat-tab *ngFor="let section of fetchedWholeAssignmentResult.sections" [label]="section.sectionName">
      <div *ngFor="let answer of section.answers; let i = index;"  class="question-card">
        <div style="display: flex; margin-bottom: 20px;">
          <div class="numberCircle">{{i + 1}}</div>
          <div class="questionName" [innerHtml]="transform(answer.name)"></div>
          <div style="    position: absolute; right: 30px;border-radius: 20px;box-shadow: 0 2px 5px 0 rgb(0 0 0 / 16%), 0 2px 10px 0 rgb(0 0 0 / 12%);">
            <mat-chip-list aria-label="Fish selection">
              <mat-chip [ngClass]="{'success-bg': answer.answerStatus == 'CORRECT', 'failure-bg' :answer.answerStatus == 'INCORRECT',  'warning-bg' : answer.answerStatus == 'SKIPPED' }" selected>
                <i class="fas fa-hourglass-half"  style="margin-right: 5px;" ></i> {{answer.timeElapsedInSec}} sec</mat-chip>
            </mat-chip-list>
          </div>
        </div>

        <div style="margin-left: 30px;">
            <div class="option"[ngClass]="{'correct': answer.correctOptions?.includes(option.key),
             'selected' : answer.selectedOptions?.includes(option.key),  'wrong' : !answer.correctOptions?.includes(option.key) }"
            *ngFor="let option of answer.inputOptions" >
              <div class="markcontainer">
                <i *ngIf="answer.answerStatus == 'CORRECT' && answer.correctOptions.includes(option.key)"   class="fas fa-check-circle success"></i>
                <i *ngIf="answer.answerStatus == 'INCORRECT' && answer.selectedOptions.includes(option.key) "  class="fas fa-times-circle failure"></i>
              </div>
              <div class="answer-list" [innerHtml]="transform(option.value)"></div>
              <!-- <mat-chip-list *ngIf="answer.correctOptions?.includes(option.key)" aria-label="Correct Answer">
                <mat-chip class="primary-bg" selected>
                   Correct Answer</mat-chip>
              </mat-chip-list> -->
              <span *ngIf="answer.correctOptions?.includes(option.key)" class="badge badge-pill badge-primary ml-2">Correct Answer</span>
            </div>
        </div>

        <div *ngIf="answer.type == 'TITA'" style="margin-left: 30px;">
            <div class="option correct">
              <div [innerHtml]="transform(answer.correctAnswerText)"></div>
            </div>
            <div class="option" [ngClass]="{'correct': answer.answerStatus  == 'CORRECT' ,  'wrong' : answer.answerStatus  == 'INCORRECT' }">
              <div [innerHtml]="transform(answer.answerText)"></div>
            </div>
        </div>
        <mat-divider></mat-divider>
        <div style="margin: 20px 30px;">
          <div style="margin-bottom: 10px;">Explanation</div>
            <div [innerHtml]="transform(answer.explanation)" disabled>Explanation</div>
        </div>
      </div>

    </mat-tab>

  </mat-tab-group>
</div>

<div *ngSwitchCase="'Ranking'"    class="student-report-list-grid">
  <div class="mat-elevation-z8">
    <div class="loading-container" *ngIf="isLoading">
      <mat-spinner *ngIf="isLoading"></mat-spinner>
    </div>
    <div class="mat-elevation-z8">
      <div>
        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          matSortActive="name"
          matSortDisableClear
        >


          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              <div>Name</div>
            </th>
            <td mat-cell *matCellDef="let row">{{ row.name }}</td>
           </ng-container>

          <ng-container matColumnDef="totalMarks">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Mark</th>
            <td mat-cell *matCellDef="let row">{{ row.totalMarks }}</td>
          </ng-container>

          <ng-container matColumnDef="marksReceived">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Mark Recieved</th>
            <td mat-cell *matCellDef="let row">{{ row.marksReceived }}</td>
          </ng-container>


          <tr mat-header-row *matHeaderRowDef="rankingDisplayedColumn"></tr>
          <tr mat-row *matRowDef="let row; columns: rankingDisplayedColumn"></tr>

        </table>
      </div>

    </div>
  </div>
</div>

</container-element>
